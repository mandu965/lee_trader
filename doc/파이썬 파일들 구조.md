ì¼ë‹¨ ë§í•´ì¤€ zip ì§„ì§œ ë‹¤ ì—´ì–´ë´¤ì–´.
í´ë” êµ¬ì¡°ëž‘ ì½”ë“œê¹Œì§€ ì§ì ‘ í›‘ì–´ì„œ, **ë­ê°€ â€œì‹¤ì œ ì“°ì´ëŠ” ì• â€ê³  ë­ê°€ â€œìžˆì–´ë„ ë˜ê³  ì—†ì–´ë„ ë˜ëŠ” ì• â€ì¸ì§€** ì •ë¦¬í•´ë³¼ê²Œ.

---

## 1. ì „ì²´ íŒŒì¼ êµ¬ì¡° ìš”ì•½

zip ì•ˆì— `.py` íŒŒì¼ë“¤ì€ ì´ë ‡ê²Œ ë‚˜ëˆ ì ¸ ìžˆì–´:

### ðŸ”¹ ë£¨íŠ¸ ê²½ë¡œ

* `backtest_combined_60d_30d.py`
* `label_consistency_check.py`
* `naver_price_downloader.py`
* `score_backtest.py`
* `score_backtest_from_labels.py`
* `walkforward_backtest.py`

### ðŸ”¹ `python/` í´ë”

* `python/run_pipeline.py`
* `python/fetch_market_data.py`
* `python/fetch_top_universe.py`
* `python/merge_universe.py`
* `python/download_prices_kis.py`
* `python/clean_prices.py`
* `python/create_adjusted_prices.py`
* `python/quality_builder.py`
* `python/feature_builder.py`
* `python/scoring.py`
* `python/label_builder.py`
* `python/model_train.py`
* `python/model_predict.py`
* `python/ranking_builder.py`
* `python/predict_history.py`
* `python/backtest.py`
* `python/backtest_walkforward.py`
* `python/model_train_optuna.py`
* `python/backfill_fact_price_daily.py`
* `python/backfill_features.py`
* `python/backfill_labels.py`
* `python/build_fundamentals_from_features.py`
* `python/clean_prices.py`
* `python/fetch_fundamentals_dart.py`
* `python/dashboard.py`
* `python/paper_trading_report.py`
* `python/paper_trading_tracker.py`
* `python/merge_universe.py`
* `python/model_predict.py`
* `python/schemas.py`
* `python/scoring.py`
* `python/requirements.txt`
* â€¦(`__pycache__`, `analysis/` í´ë” í¬í•¨)

---

## 2. â€œì‹¤ì œë¡œ ì“°ëŠ” ì• ë“¤â€ vs â€œì§€ê¸ˆì€ ì•ˆ ì¨ë„ ë˜ëŠ” ì• ë“¤â€

### âœ… 2-1. **í•µì‹¬ í”„ë¡œë•ì…˜ íŒŒì´í”„ë¼ì¸ (ë°˜ë“œì‹œ ì“°ëŠ” ì• ë“¤)**

`python/run_pipeline.py` ì•ˆ STEP ë¦¬ìŠ¤íŠ¸ ê¸°ì¤€ìœ¼ë¡œ ë³´ë©´,
**ì‹¤ì œ â€œì˜ˆì¸¡ ë¦¬ìŠ¤íŠ¸â€ë¥¼ ë§Œë“¤ ë•Œ ëŒì•„ê°€ëŠ” ë³¸ì²´**ëŠ” ì´ ë¼ì¸ì—…ì´ì•¼:

```python
STEPS = [
    ("fetch_market_data", "python/fetch_market_data.py"),
    ("fetch_top_universe", "python/fetch_top_universe.py"),
    ("merge_universe", "python/merge_universe.py"),
    ("download_prices_kis", "python/download_prices_kis.py"),
    ("clean_prices", "python/clean_prices.py"),
    ("create_adjusted_prices", "python/create_adjusted_prices.py"),
    # ("fetch_fundamentals_dart", "python/fetch_fundamentals_dart.py"),
    ("quality_builder", "python/quality_builder.py"),
    ("feature_builder", "python/feature_builder.py"),
    ("scoring", "python/scoring.py"),
    ("label_builder", "python/label_builder.py"),
    ("model_train", "python/model_train.py"),
    ("model_predict", "python/model_predict.py"),
    ("ranking_builder", "python/ranking_builder.py"),
    ("migrate_to_sqlite", "migrate_to_sqlite.py"),
]
```

ì—¬ê¸°ì„œ **ì‹¤ì œ ìžˆëŠ” íŒŒì¼ + ì“°ì´ëŠ” ì• ë“¤**:

* `python/fetch_market_data.py`
* `python/fetch_top_universe.py`
* `python/merge_universe.py`
* `python/download_prices_kis.py`
* `python/clean_prices.py`
* `python/create_adjusted_prices.py`
* `python/quality_builder.py`
* `python/feature_builder.py`
* `python/scoring.py`
* `python/label_builder.py`
* `python/model_train.py`
* `python/model_predict.py`
* `python/ranking_builder.py`
* * ì´ê±¸ ìˆœì„œëŒ€ë¡œ ëŒë¦¬ëŠ” `python/run_pipeline.py`

ê·¸ë¦¬ê³  ì´ë“¤ì´ ê³µí†µìœ¼ë¡œ ì“°ëŠ” **ìœ í‹¸/ì •ì˜**:

* `python/schemas.py` (ë°ì´í„° ìŠ¤í‚¤ë§ˆ)
* `python/requirements.txt` (í™˜ê²½ ì •ì˜)

ðŸ‘‰ ì´ ë¼ì¸ì—…ì´ **â€œì˜ˆì¸¡ ë¦¬ìŠ¤íŠ¸ í™”ë©´ì— ëœ¨ëŠ” ê°’(pred_return_60d, pred_mdd_60d, final_score ë“±)ì„ ë§Œë“œëŠ” ì§„ì§œ ë³¸ì²´â€**ë¼ê³  ë³´ë©´ ë¼.

---

### âœ… 2-2. **ë£¨íŠ¸ ê²½ë¡œì—ì„œ â€œì§€ê¸ˆ ì‹¤ì œë¡œ ë„¤ê°€ ì“°ê³  ìžˆëŠ” ë„êµ¬ë“¤â€**

ìµœê·¼ ëŒ€í™” + ì½”ë“œ ê¸°ì¤€ìœ¼ë¡œ **ì§€ê¸ˆ ìžì£¼ ì“°ëŠ” ë£¨íŠ¸ ìŠ¤í¬ë¦½íŠ¸**ëŠ”:

* `walkforward_backtest.py`
  â†’ **walk-forward ë°±í…ŒìŠ¤íŠ¸** (split s1/s2, top_k, holding_days, rebalance=biweekly ë“±)

* `backtest_combined_60d_30d.py`
  â†’ 60d / 30d ì˜ˆì¸¡ì„ í•©ì³ì„œ **combined_90_10 ì „ëžµ ë°±í…ŒìŠ¤íŠ¸**í•˜ëŠ” ìŠ¤í¬ë¦½íŠ¸
  â†’ `prediction_history_60d_biweekly.csv`, `prediction_history_30d_biweekly.csv`, `labels.csv`ë¥¼ ì½ì–´ì„œ
  `data/backtest_walkforward_combined_90_10_top10_{trades,summary}.csv` ìƒì„±

* `score_backtest_from_labels.py`
  â†’ `labels.csv + scores_final.csv` ê¸°ë°˜ **ì ìˆ˜ ì „ëžµ ë°±í…ŒìŠ¤íŠ¸**

* `score_backtest.py`
  â†’ `score_backtest_from_labels` ê²°ê³¼ë¥¼ ë°›ì•„ì„œ **ë¶„ìœ„ìˆ˜ë³„(final_score/pred_return_60d) ì„±ëŠ¥ ë¶„ì„**

* `label_consistency_check.py`
  â†’ labels, predictions, pricesë¥¼ ë‹¤ì‹œ ê³„ì‚°í•´ ë³´ëŠ” **ë””ë²„ê·¸ìš© íˆ´** (ì‹¤ì „ í•„ìˆ˜ëŠ” ì•„ë‹ˆì§€ë§Œ ìœ ìš©)

* `naver_price_downloader.py`
  â†’ ë„¤ì´ë²„ì—ì„œ ê°€ê²© ê¸ì–´ì˜¤ëŠ” **ë³„ë„ ë°ì´í„° ìˆ˜ì§‘ìš©** ìŠ¤í¬ë¦½íŠ¸ (KIS ëŒ€ì‹ /ë³´ì™„ìš©)

ì´ê±´ ì „ë¶€ `if __name__ == "__main__":` ë¸”ë¡ì´ ìžˆê³ ,
ì‹¤ì œ CLIë¡œ `python walkforward_backtest.py ...` ì´ëŸ° ì‹ìœ¼ë¡œ ëŒë¦¬ëŠ” ìš©ë„ì•¼.
**= ì§€ê¸ˆ ë°±í…ŒìŠ¤íŠ¸/ë¶„ì„ ìž‘ì—…í•  ë•Œ â€œì™„ì „ížˆ ì‚´ì•„ìžˆëŠ” ìŠ¤í¬ë¦½íŠ¸ë“¤â€** ë§žë‹¤.

---

### âšª 2-3. **ì§€ê¸ˆì€ ì•ˆ ëŒë ¤ë„ ë˜ëŠ”/êµ¬ë²„ì „/ì‹¤í—˜ìš© ìŠ¤í¬ë¦½íŠ¸ë“¤**

#### python í´ë” ì•ˆìª½

* `python/backtest.py`
  â†’ ì˜›ë‚  ë‹¨ìˆœ ë°±í…ŒìŠ¤íŠ¸ìš©. í˜„ìž¬ íŒŒì´í”„ë¼ì¸ / UIì—ì„œëŠ” ì•ˆ ì”€.

* `python/backtest_walkforward.py`
  â†’ ë£¨íŠ¸ `walkforward_backtest.py`ëž‘ ë‚´ìš©ì´ ê±°ì˜ ê°™ì€ **ì˜› ë²„ì „/ë³„ë„ CLI**.
  â†’ ìš”ì¦˜ ë„ˆê°€ ì“°ëŠ” ê±´ ë£¨íŠ¸ `walkforward_backtest.py` ìª½.

* `python/predict_history.py`
  â†’ `model.pkl` + `features.csv`ì—ì„œ `predictions_history.csv` ë§Œë“œëŠ” **ì˜ˆì „ ë°©ì‹**
  â†’ ì§€ê¸ˆì€ `walkforward_backtest.py`ì—ì„œ `prediction_history_60d_biweekly.csv`ì²˜ëŸ¼
  ë” ì •êµí•œ walk-forward prediction historyë¥¼ ë§Œë“¤ê¸° ë•Œë¬¸ì—,
  **í˜„ìž¬ í”Œë¡œìš° ê¸°ì¤€ì—ì„  í•„ìˆ˜ê°€ ì•„ë‹˜.**

* `python/model_train_optuna.py`
  â†’ **í•˜ì´í¼íŒŒë¼ë¯¸í„° íŠœë‹(Optuna)**ìš©.
  â†’ ì„±ëŠ¥ ë” ì˜¬ë¦¬ê³  ì‹¶ì„ ë•Œ ìˆ˜ë™ìœ¼ë¡œ ëŒë¦¬ëŠ” ìš©ë„.

* `python/backfill_fact_price_daily.py`

* `python/backfill_features.py`

* `python/backfill_labels.py`
  â†’ ê³¼ê±° ë°ì´í„° ì „ë¶€ ë‹¤ì‹œ ì±„ìš°ê±°ë‚˜, êµ¬ë©ë‚œ ê¸°ê°„ ë©”ê¾¸ëŠ” **ë°±í•„(backfill) ìœ í‹¸**.
  â†’ ì§€ê¸ˆ â€œìµœì‹  êµ¬ê°„ë§Œ ì“°ëŠ”â€ ì‹¤í—˜ ë ˆë²¨ì—ì„œëŠ” ì•ˆ ëŒë ¤ë„ ë¨.

* `python/build_fundamentals_from_features.py`

* `python/fetch_fundamentals_dart.py`
  â†’ íŽ€ë”ë©˜í„¸(DART) ê¸°ë°˜ ì •ë³´ ë¶™ì—¬ì„œ **íŽ€ë”ë©˜í„¸ í”¼ì²˜ ë§Œë“œëŠ” ìœ í‹¸**
  â†’ ì§€ê¸ˆ ì „ëžµì€ **ê°€ê²©/ìˆ˜ê¸‰/í€„ë¦¬í‹° ìœ„ì£¼ë¼, ì•„ì§ main pipelineì— ì•ˆ ë“¤ì–´ê°€ ìžˆìŒ**.

* `python/dashboard.py`
  â†’ íŒŒì´ì¬ ê¸°ë°˜ ê°„ë‹¨ ëŒ€ì‹œë³´ë“œìš©ìœ¼ë¡œ ë³´ì´ì§€ë§Œ
  â†’ Node/ì›¹ UI ë³„ë„ë¡œ ì“°ê³  ìžˆì–´ì„œ **í˜„ìž¬ëŠ” off** ìƒíƒœ.

* `python/paper_trading_report.py`

* `python/paper_trading_tracker.py`
  â†’ ëª¨ì˜íˆ¬ìž(paper trading) ê²°ê³¼ íŒŒì¼ì„ ì •ë¦¬í•˜ëŠ” ìš©ë„.
  â†’ ì•„ì§ ë³¸ê²© ëª¨ì˜ìš´ìš© ì²´ê³„ë¥¼ ì•ˆ ëŒë¦¬ë‹ˆê¹Œ ë‹¹ìž¥ì€ ì—†ì–´ë„ ë¨.

---

### âš ï¸ 2-4. **â€œí•„ìš”í•œë° êµ¬í˜„ ì•ˆ ëœ ìƒíƒœâ€ ë”± í•œ ê°œ**

`python/run_pipeline.py` ë§ˆì§€ë§‰ ìŠ¤í…ì— ì´ëŸ° ê²Œ ìžˆì–´:

```python
("migrate_to_sqlite", "migrate_to_sqlite.py"),
```

ê·¼ë° zip ì•ˆ íŒŒì¼ ëª©ë¡ì„ ë³´ë©´:

* ë£¨íŠ¸ì—ë„ `migrate_to_sqlite.py` ì—†ìŒ
* `python/` ì•ˆì—ë„ ì—†ìŒ

ì¦‰:

> **ì‹¤ì œë¡œ `python/run_pipeline.py`ë¥¼ ê·¸ëŒ€ë¡œ ëŒë¦¬ë©´
> ë§ˆì§€ë§‰ ë‹¨ê³„ì—ì„œ `FileNotFoundError: migrate_to_sqlite.py not found`ê°€ ë‚œë‹¤.**

= ì´ê²Œ **â€œí•„ìš”í•œë° ì•„ì§ êµ¬í˜„ ì•ˆ ëœ ë¶€ë¶„â€** í•˜ë‚˜ì•¼.
(ìš°ë¦¬ê°€ ì´ì „ì— ì–˜ê¸°í–ˆë˜ â€œSQLiteë¡œ ì´ê´€â€ ë‹¨ê³„ê°€ ì—¬ê¸°.)

---

## 3. ìš”ì•½: â€œë­ê°€ ì§„ì§œ ì‚´ì•„ ìžˆê³ , ë­˜ ê¸°ì¤€ìœ¼ë¡œ ê´€ë¦¬í•˜ë©´ ë˜ëƒ?â€

### âœ… ë£¨íŠ¸ì—ì„œ **ì§„ì§œ ì“°ëŠ” ì• ë“¤**

* `walkforward_backtest.py` â†’ walk-forward ë°±í…ŒìŠ¤íŠ¸
* `backtest_combined_60d_30d.py` â†’ 60d/30d í†µí•© ì „ëžµ ë°±í…ŒìŠ¤íŠ¸
* `score_backtest_from_labels.py` / `score_backtest.py` â†’ ì ìˆ˜ ì „ëžµ ë¶„ì„
* `label_consistency_check.py` â†’ ë¼ë²¨/ì˜ˆì¸¡/ê°€ê²© ì •í•©ì„± í…ŒìŠ¤íŠ¸
* `naver_price_downloader.py` â†’ (ì„ íƒ) ë„¤ì´ë²„ ê°€ê²© ìˆ˜ì§‘

### âœ… `python/` í´ë”ì—ì„œ **í”„ë¡œë•ì…˜ íŒŒì´í”„ë¼ì¸ ë³¸ì²´**

* `python/run_pipeline.py` + ì•„ëž˜ ìŠ¤í…ë“¤:

  * `python/fetch_market_data.py`
  * `python/fetch_top_universe.py`
  * `python/merge_universe.py`
  * `python/download_prices_kis.py`
  * `python/clean_prices.py`
  * `python/create_adjusted_prices.py`
  * `python/quality_builder.py`
  * `python/feature_builder.py`
  * `python/scoring.py`
  * `python/label_builder.py`
  * `python/model_train.py`
  * `python/model_predict.py`
  * `python/ranking_builder.py`
* * ê³µí†µ ìœ í‹¸:

  - `python/schemas.py`
  - `python/requirements.txt`

### âšª **ìžˆìœ¼ë©´ ì¢‹ì€/ì§€ê¸ˆì€ ì•ˆ ê¸‰í•œ ì• ë“¤**

* `python/backtest.py`, `python/backtest_walkforward.py` (ì˜› ë²„ì „ ë°±í…ŒìŠ¤íŠ¸)
* `python/predict_history.py` (ì˜› ì˜ˆì¸¡ ížˆìŠ¤í† ë¦¬ ë°©ì‹)
* `python/model_train_optuna.py` (íŠœë‹ìš©)
* backfill/íŽ€ë”ë©˜í„¸/ëŒ€ì‹œë³´ë“œ/paper_trading ìœ í‹¸ë“¤

### âš ï¸ **ë¶€ì¡±í•œ í•œ ì¡°ê°**

* `migrate_to_sqlite.py` â†’ run_pipeline ë§ˆì§€ë§‰ ìŠ¤í…ì¸ë°, ì•„ì§ ì‹¤ì œ íŒŒì¼ ì—†ìŒ
  â†’ â€œDBí™”/SQLite ì´ê´€â€ì„ ë³¸ê²© ì§„í–‰í•  ë•Œ **ìƒˆë¡œ ë§Œë“¤ì–´ì•¼ í•˜ëŠ” íŒŒíŠ¸**

---

## 4. ì •ë¦¬í•´ì„œ ì²´í¬ë¦¬ìŠ¤íŠ¸ ëŠë‚Œìœ¼ë¡œ

VSCodeì—ì„œ ê´€ë¦¬í•˜ê¸° ì‰½ê²Œ, ë”± ì´ ì •ë„ë¡œ êµ¬ë¶„í•´ì„œ ë³´ë©´ ì¢‹ì•„:

```markdown
## ì‹¤ì œ í”„ë¡œë•ì…˜ íŒŒì´í”„ë¼ì¸ (í•­ìƒ ìœ ì§€)
- [x] python/run_pipeline.py
- [x] python/fetch_market_data.py
- [x] python/fetch_top_universe.py
- [x] python/merge_universe.py
- [x] python/download_prices_kis.py
- [x] python/clean_prices.py
- [x] python/create_adjusted_prices.py
- [x] python/quality_builder.py
- [x] python/feature_builder.py
- [x] python/scoring.py
- [x] python/label_builder.py
- [x] python/model_train.py
- [x] python/model_predict.py
- [x] python/ranking_builder.py
- [x] python/schemas.py

## ë°±í…ŒìŠ¤íŠ¸/ë¶„ì„ ë„êµ¬ (ìˆ˜ë™ ì‹¤í–‰)
- [x] walkforward_backtest.py
- [x] backtest_combined_60d_30d.py
- [x] score_backtest_from_labels.py
- [x] score_backtest.py
- [x] label_consistency_check.py

## ë°ì´í„° ìˆ˜ì§‘/ë³´ì¡°
- [x] naver_price_downloader.py
- [ ] python/fetch_fundamentals_dart.py (ì›í•˜ë©´ í™œì„±í™”)
- [ ] python/backfill_*.py (í•„ìš”í•  ë•Œë§Œ)

## êµ¬ë²„ì „/ì‹¤í—˜/ì„ íƒì 
- [ ] python/backtest.py
- [ ] python/backtest_walkforward.py
- [ ] python/predict_history.py
- [ ] python/model_train_optuna.py
- [ ] python/dashboard.py
- [ ] python/paper_trading_report.py
- [ ] python/paper_trading_tracker.py

## ì•„ì§ ì—†ëŠ” ê²ƒ (í•„ìš”ì‹œ êµ¬í˜„)
- [ ] migrate_to_sqlite.py
```

---

ì´ë ‡ê²Œ ë³´ë©´:

* â€œì–´ë–¤ íŒŒì¼ì´ ì§„ì§œ í˜„ ì‹œìŠ¤í…œì˜ ì‹¬ìž¥ì¸ì§€â€
* â€œì–´ë–¤ ê±´ ì˜ˆì „ ë²„ì „/ì˜µì…˜ì¸ì§€â€
* â€œë¬´ì—‡ì´ ì•„ì§ êµ¬í˜„ì´ ì•ˆ ëœ ìƒíƒœì¸ì§€â€

í•œëˆˆì— ì •ë¦¬ë  ê±°ì•¼.

ë‹¤ìŒ ìŠ¤í…ìœ¼ë¡œëŠ”
ðŸ‘‰ `migrate_to_sqlite.py`ë¥¼ ì„¤ê³„í• ì§€,
ðŸ‘‰ ì•„ë‹ˆë©´ `run_pipeline` + `walkforward_backtest.py` ì‚¬ìš© í”Œë¡œìš°ë¥¼ ë¬¸ì„œí™”í• ì§€
ë‘˜ ì¤‘ í•˜ë‚˜ ê³¨ë¼ì„œ ì´ì–´ê°€ë©´ ë”± ì¢‹ì„ ê²ƒ ê°™ë‹¤.



"""
CSV -> SQLite migration helper.
- Creates data/lee_trader.db
- Creates tables: stocks, daily_ranking, daily_scores, labels, backtest_trades
- Loads data from existing CSV outputs.
Run once after CSVs are generated:
    python migrate_to_sqlite.py
"""
DB_PATH = data/lee_trader.db

# ì£¼ìš” ì†ŒìŠ¤ CSV
UNIVERSE_CSV      = data/universe.csv
RANKING_CSV      = data/ranking_final.csv
SCORES_CSV       = data/scores_final.csv
LABELS_CSV       = data/labels.csv
BACKTEST_CSV     = data/analysis/score_backtest_from_labels.csv
MARKET_STATUS_CSV= data/market_status.csv
PRICES_*_CSV     = data/prices_daily_*.csv
FUND_CSV         = data/fundamentals.csv
QUALITY_CSV      = data/quality.csv
FEATURES_CSV     = data/features.csv
PREDICTIONS_CSV  = data/predictions.csv
